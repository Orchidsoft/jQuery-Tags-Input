(function(a){var b=0;a.fn.doAutosize=function(b){var c=a(this).data("minwidth"),d=a(this).data("maxwidth"),e="",f=a(this),g=a("#"+a(this).data("tester_id"));if(e===(e=f.val())){return}var h=e.replace(/&/g,"&").replace(/\s/g," ").replace(/</g,"<").replace(/>/g,">");g.html(h);var i=g.width(),j=i+b.comfortZone>=c?i+b.comfortZone:c,k=f.width(),l=j<k&&j>=c||j>c&&j<d;if(l){f.width(j)}};a.fn.resetAutosize=function(b){var c=a(this).data("minwidth")||b.minInputWidth||a(this).width(),d=a(this).data("maxwidth")||b.maxInputWidth||a(this).closest(".tagsinput").width()-b.inputPadding,e="",f=a(this),g=a("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:f.css("fontSize"),fontFamily:f.css("fontFamily"),fontWeight:f.css("fontWeight"),letterSpacing:f.css("letterSpacing"),whiteSpace:"nowrap"}),h=a(this).attr("id")+"_autosize_tester";if(!a("#"+h).length>0){g.attr("id",h);g.appendTo("body")}f.data("minwidth",c);f.data("maxwidth",d);f.data("tester_id",h);f.css("width",c)};a.fn.addTag=function(b,c){c=jQuery.extend({focus:false,callback:true},c);this.each(function(){var d=a(this).data("settings");var e=a(this).val().split(d.delimiter);if(e[0]==""){e=new Array}b=jQuery.trim(b);var f=false;if(c.unique){f=a(this).tagExist(b);if(f==true){a(d.fake_input).addClass("not_valid");if(d.onError){var g=d.onError;g.call(this,"duplicate")}}}if(d.validateTag){var g=d.validateTag;if(!g.call(this,b)){f=true;a(d.fake_input).addClass("not_valid");if(d.onError){var g=d.onError;g.call(this,"validation")}}}if(b!=""&&f!=true){if(d.onCreateTag){var h=a(d.onCreateTag(b));if(!h.hasClass("tag"))h.addClass("tag");h.find("[rel='remove']").attr({href:"#",title:d.removeText}).click(function(){return a(d.real_input).removeTag(escape(b))});h.insertBefore(d.input_wrapper)}else{a("<span>").addClass("tag").append(a("<span>").text(b).append("  "),a("<a>",{href:"#",title:d.removeText,text:"x"}).click(function(){return a(d.real_input).removeTag(escape(b))})).insertBefore(d.input_wrapper)}e.push(b);a(d.fake_input).val("");if(c.focus){a(d.fake_input).focus()}else{a(d.fake_input).blur()}a.fn.tagsInput.updateTagsField(this,e);if(d.onAddTag){var g=d.onAddTag;g.call(this,b)}if(d.onChange){var i=e.length;var g=d.onChange;g.call(this,a(this),e[i-1])}}});return false};a.fn.removeTag=function(b){b=unescape(b);this.each(function(){var c=a(this).data("settings");var d=a(this).val().split(c.delimiter);a(c.holder+" .tag").remove();str="";for(i=0;i<d.length;i++){if(d[i]!=b){str=str+c.delimiter+d[i]}}a.fn.tagsInput.importTags(this,str);if(c.onRemoveTag){var e=c.onRemoveTag;e.call(this,b)}});return false};a.fn.tagExist=function(b){var c=a(this).data("settings");var d=a(this).val().split(c.delimiter);return jQuery.inArray(b,d)>=0};a.fn.importTags=function(b){var c=a(this).data("settings");a(c.holder+" .tag").remove();a.fn.tagsInput.importTags(this,b)};a.fn.tagsInput=function(c){var d=jQuery.extend({interactive:true,defaultText:"add a tag",removeText:"Remove Tag",minChars:0,width:"auto",minHeight:"100px",height:"auto",autocomplete:null,autocompleteselect:null,onlyautocomplete:false,hide:true,delimiter:",",unique:true,removeWithBackspace:true,placeholderColor:"#666666",autosize:true,comfortZone:20,inputPadding:6*2,onChange:null,onAddTag:null,onRemoveTag:null,validateTag:null,onError:null,onCreateTag:null},c);this.each(function(){if(d.hide){a(this).hide()}var c=b++;var e=jQuery.extend({pid:c,real_input:this,holder:"#"+c+"_tagsinput",input_wrapper:"#"+c+"_addTag",fake_input:"#"+c+"_tag"},d);a(this).addClass("tagsinput_processed");var f='<div id="'+c+'_tagsinput" class="tagsinput"><div id="'+c+'_addTag" class="tagsinput_inputwrapper">';if(d.interactive){f=f+'<input id="'+c+'_tag" value="" data-default="'+d.defaultText+'" />'}f=f+'</div><div class="tags_clear"></div></div>';a(f).insertAfter(this);a(e.holder).css("width",d.width);a(e.holder).css("height",d.height);a(e.holder).css("min-height",d.minHeight);a(this).data("settings",e);if(a(this).val()!=""){a.fn.tagsInput.importTags(a(this),a(this).val())}if(d.interactive){a(e.fake_input).val(a(e.fake_input).attr("data-default"));a(e.fake_input).css("color",d.placeholderColor);a(e.fake_input).resetAutosize(d);a(e.holder).on("click",e,function(b){a(b.data.fake_input).focus()});a(e.fake_input).on("focus",e,function(b){if(a(b.data.fake_input).val()==a(b.data.fake_input).attr("data-default")){a(b.data.fake_input).val("")}a(b.data.fake_input).css("color","#000000");if(d.autocomplete){var c=a(b.data.fake_input).autocomplete("option","minLength");if(a(b.data.fake_input).val().length>=c){a(b.data.fake_input).autocomplete("search")}}});if(d.autocomplete){a(e.fake_input).autocomplete(d.autocomplete);if(d.autocompleteselect){a(e.fake_input).on("autocompleteselect",e,d.autocompleteselect)}else{a(e.fake_input).on("autocompleteselect",e,function(b,c){a(b.data.real_input).addTag(c.item.value,{focus:true,unique:d.unique});return false})}a(e.fake_input).on("autocompleteopen",e,function(){a(this).data("autocompleteopen",true);return false});a(e.fake_input).on("autocompleteclose",e,function(){a(this).data("autocompleteopen",null);return false})}a(e.fake_input).on("blur",e,function(b){if(a(b.data.fake_input).val()!=""&&a(b.data.fake_input).val()!=b.data.defaultText){if(!a(this).data("autocompleteopen")){if(b.data.onlyautocomplete==false&&b.data.minChars<=a(b.data.fake_input).val().length&&(!b.data.maxChars||b.data.maxChars>=a(b.data.fake_input).val().length))a(b.data.real_input).addTag(a(b.data.fake_input).val(),{focus:true,unique:d.unique})}else{}}else{a(b.data.fake_input).val(b.data.defaultText);a(b.data.fake_input).css("color",b.data.placeholderColor);a(b.data.fake_input).removeClass("not_valid")}return false});a(e.fake_input).on("keypress",e,function(b){if(b.which==b.data.delimiter.charCodeAt(0)||b.which==13){b.preventDefault();if(b.data.onlyautocomplete==false&&b.data.minChars<=a(b.data.fake_input).val().length&&(!b.data.maxChars||b.data.maxChars>=a(b.data.fake_input).val().length))a(b.data.real_input).addTag(a(b.data.fake_input).val(),{focus:true,unique:d.unique});a(b.data.fake_input).resetAutosize(d);return false}else if(b.data.autosize){a(b.data.fake_input).doAutosize(d)}});a(e.fake_input).on("keydown",e,function(b){if(e.removeWithBackspace&&b.keyCode==8&&a(this).val()==""){b.preventDefault();var c=a(this).closest(".tagsinput").find(".tag:last").text();c=c.replace(/[\s]+x$/,"");a(e.real_input).removeTag(escape(c));a(this).trigger("focus")}if(b.keyCode==32&&b.ctrlKey){if(!a(this).data("autocompleteopen")){a(this).autocomplete("search")}}});a(e.fake_input).blur();if(e.unique||e.validateTag){a(e.fake_input).keydown(function(b){if(b.keyCode==8||String.fromCharCode(b.which).match(/\w+|[áéíóúÁÉÍÓÚñÑ,/]+/)){a(this).removeClass("not_valid")}})}}});return this};a.fn.tagsInput.updateTagsField=function(b,c){var d=a(b).data("settings");a(b).val(c.join(d.delimiter))};a.fn.tagsInput.importTags=function(b,c){var d=a(b).data("settings");a(b).val("");var e=c.split(d.delimiter);for(i=0;i<e.length;i++){a(b).addTag(e[i],{focus:false,callback:false})}if(d.onChange){var f=d.onChange;f.call(b,b,e[i])}}})(jQuery)