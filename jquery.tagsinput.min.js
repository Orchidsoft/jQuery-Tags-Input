!function(t){var a=0;t.fn.doAutosize=function(a){var e=t(this).data("minwidth"),i=t(this).data("maxwidth"),n="",o=t(this),s=t("#"+t(this).data("tester_id"));if(n!==(n=o.val())){var u=n.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");s.html(u);var r=s.width(),l=r+a.comfortZone>=e?r+a.comfortZone:e,d=o.width(),p=d>l&&l>=e||l>e&&i>l;p&&o.width(l)}},t.fn.resetAutosize=function(a){var e=t(this).data("minwidth")||a.minInputWidth||t(this).width(),i=t(this).data("maxwidth")||a.maxInputWidth||t(this).closest(".tagsinput").width()-a.inputPadding,n=t(this),o=t("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:n.css("fontSize"),fontFamily:n.css("fontFamily"),fontWeight:n.css("fontWeight"),letterSpacing:n.css("letterSpacing"),whiteSpace:"nowrap"}),s=t(this).attr("id")+"_autosize_tester";!t("#"+s).length>0&&(o.attr("id",s),o.appendTo("body")),n.data("minwidth",e),n.data("maxwidth",i),n.data("tester_id",s),n.doAutosize(a)},t.fn.addTag=function(a,e){return e=jQuery.extend({focus:!1,callback:!0},e),this.each(function(){var i=t(this).data("settings"),n=t(this).val().split(i.delimiter);""==n[0]&&(n=new Array),a=jQuery.trim(a);var o=!1;if(e.unique&&(o=t(this).tagExist(a),1==o&&(t(i.fake_input).addClass("not_valid"),i.onError))){var s=i.onError;s.call(this,"duplicate")}if(i.validateTag){var s=i.validateTag;if(!s.call(this,a)&&(o=!0,t(i.fake_input).addClass("not_valid"),i.onError)){var s=i.onError;s.call(this,"validation")}}if(""!=a&&1!=o){if(i.onCreateTag){var u=t(i.onCreateTag(a));u.hasClass("tag")||u.addClass("tag"),u.find("[rel='remove']").attr({href:"#",title:i.removeText}).click(function(){return t(i.real_input).removeTag(escape(a))}),u.insertBefore(i.input_wrapper)}else t("<span>").addClass("tag").append(t("<span>").text(a).append("&nbsp;&nbsp;"),t("<a>",{href:"#",title:i.removeText,text:"x"}).click(function(){return t(i.real_input).removeTag(escape(a))})).insertBefore(i.input_wrapper);if(n.push(a),t(i.fake_input).val(""),e.focus?t(i.fake_input).focus():t(i.fake_input).blur(),t.fn.tagsInput.updateTagsField(this,n),i.onAddTag){var s=i.onAddTag;s.call(this,a)}if(i.onChange){var r=n.length,s=i.onChange;s.call(this,t(this),n[r-1])}}}),!1},t.fn.removeTag=function(a){return a=unescape(a),this.each(function(){var e=t(this).data("settings"),n=t(this).val().split(e.delimiter);for(t(e.holder+" .tag").remove(),str="",i=0;i<n.length;i++)n[i]!=a&&(str=str+e.delimiter+n[i]);if(t.fn.tagsInput.importTags(this,str),e.onRemoveTag){var o=e.onRemoveTag;o.call(this,a)}}),!1},t.fn.clearTags=function(){this.each(function(){var a=t(this).data("settings"),e=t(this).val().split(a.delimiter);t(a.holder+" .tag").remove(),t(this).val(""),t.each(e,function(t,e){if(a.onRemoveTag){var i=a.onRemoveTag;i.call(this,e)}})})},t.fn.tagExist=function(a){var e=t(this).data("settings"),i=t(this).val().split(e.delimiter);return jQuery.inArray(a,i)>=0},t.fn.importTags=function(a){var e=t(this).data("settings");t(e.holder+" .tag").remove(),t.fn.tagsInput.importTags(this,a)},t.fn.tagsInput=function(e){var i=jQuery.extend({interactive:!0,defaultText:"add a tag",removeText:"Remove Tag",minChars:0,width:"auto",minHeight:"none",height:"auto",autocomplete:null,autocompleteselect:null,onlyautocomplete:!1,hide:!0,delimiter:",",unique:!0,removeWithBackspace:!0,placeholderColor:"#666666",autosize:!0,comfortZone:20,inputPadding:12,onChange:null,onAddTag:null,onRemoveTag:null,validateTag:null,onError:null,onCreateTag:null},e);return this.each(function(){i.hide&&t(this).hide();var e=a++,n=jQuery.extend({pid:e,real_input:this,holder:"#"+e+"_tagsinput",input_wrapper:"#"+e+"_addTag",fake_input:"#"+e+"_tag"},i);t(this).addClass("tagsinput_processed");var o='<div id="'+e+'_tagsinput" class="tagsinput"><div id="'+e+'_addTag" class="tagsinput_inputwrapper">';i.interactive&&(o=o+'<input id="'+e+'_tag" value="" data-default="'+i.defaultText+'" />'),o+='</div><div class="tags_clear"></div></div>',t(o).insertAfter(this),t(n.holder).css("width",i.width),t(n.holder).css("height",i.height),t(n.holder).css("min-height",i.minHeight),t(this).data("settings",n),""!=t(this).val()&&t.fn.tagsInput.importTags(t(this),t(this).val()),i.interactive&&(t(n.fake_input).val(t(n.fake_input).attr("data-default")),t(n.fake_input).css("color",i.placeholderColor),t(n.fake_input).resetAutosize(i),t(n.holder).on("click",n,function(a){t(a.data.fake_input).focus()}),t(n.fake_input).on("focus",n,function(a){if(t(a.data.fake_input).val()==t(a.data.fake_input).attr("data-default")&&t(a.data.fake_input).val(""),t(a.data.fake_input).css("color","#000000"),i.autocomplete){var e=t(a.data.fake_input).autocomplete("option","minLength");t(a.data.fake_input).val().length>=e&&t(a.data.fake_input).autocomplete("search")}}),i.autocomplete&&(t(n.fake_input).autocomplete(i.autocomplete),i.autocompleteselect?t(n.fake_input).on("autocompleteselect",n,i.autocompleteselect):t(n.fake_input).on("autocompleteselect",n,function(a,e){return t(a.data.real_input).addTag(e.item.value,{focus:!0,unique:i.unique}),!1}),t(n.fake_input).on("autocompleteopen",n,function(){return t(this).data("autocompleteopen",!0),!1}),t(n.fake_input).on("autocompleteclose",n,function(){return t(this).data("autocompleteopen",null),!1})),t(n.fake_input).on("blur",n,function(a){return""!=t(a.data.fake_input).val()&&t(a.data.fake_input).val()!=a.data.defaultText?t(this).data("autocompleteopen")||0==a.data.onlyautocomplete&&a.data.minChars<=t(a.data.fake_input).val().length&&t.fn.tagsInput.validateMaxChars(i,a)&&t(a.data.real_input).addTag(t(a.data.fake_input).val(),{focus:!0,unique:i.unique}):(t(a.data.fake_input).val(a.data.defaultText),t(a.data.fake_input).css("color",a.data.placeholderColor),t(a.data.fake_input).removeClass("not_valid"),t(a.data.fake_input).resetAutosize(i)),!1}),t(n.fake_input).on("paste",n,function(a){setTimeout(function(){var e=t(a.data.fake_input),i=e.val(),n=new RegExp(a.data.delimiter,"g");i=i.replace(n,""),e.val(i)},0)}),t(n.fake_input).on("keypress",n,function(a){return a.which==a.data.delimiter.charCodeAt(0)||13==a.which?(a.preventDefault(),0==a.data.onlyautocomplete&&a.data.minChars<=t(a.data.fake_input).val().length&&t.fn.tagsInput.validateMaxChars(i,a)&&(t(".ui-autocomplete").hide(),t(a.data.fake_input).trigger("autocompleteclose",[n]),t(a.data.real_input).addTag(t(a.data.fake_input).val(),{focus:!0,unique:i.unique}),t(a.data.fake_input).resetAutosize(i)),!1):void(a.data.autosize&&t(a.data.fake_input).doAutosize(i))}),t(n.fake_input).on("keydown",n,function(a){if(n.removeWithBackspace&&8==a.keyCode&&""==t(this).val()){a.preventDefault();var e=t(this).closest(".tagsinput").find(".tag:last").text();e=e.replace(/[\s]+x$/,""),t(n.real_input).removeTag(escape(e)),t(this).trigger("focus")}32==a.keyCode&&a.ctrlKey&&(t(this).data("autocompleteopen")||t(this).autocomplete("search"))}),t(n.fake_input).blur(),(n.unique||n.validateTag)&&t(n.fake_input).keydown(function(a){(8==a.keyCode||String.fromCharCode(a.which).match(/\w+|[áéíóúÁÉÍÓÚñÑ,/]+/))&&t(this).removeClass("not_valid")}))}),this},t.fn.tagsInput.updateTagsField=function(a,e){var i=t(a).data("settings");t(a).val(e.join(i.delimiter))},t.fn.tagsInput.importTags=function(a,e){var n=t(a).data("settings");t(a).val("");var o=e.split(n.delimiter);for(i=0;i<o.length;i++)t(a).addTag(o[i],{focus:!1,callback:!1});if(n.onChange){var s=n.onChange;s.call(a,a,o[i])}},t.fn.tagsInput.validateMaxChars=function(a,e){var i=!e.data.maxChars||e.data.maxChars>=t(e.data.fake_input).val().length;return i||(t(e.data.fake_input).addClass("not_valid"),t(e.data.fake_input).css("width","100%"),t(e.data.fake_input).parent(".tagsinput_inputwrapper").css("width","100%")),i}}(jQuery);